<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DietPlanner Pro</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons (‰ªçÁî®Êñº UI Êéß‰ª∂Â¶ÇËèúÂñÆ„ÄÅÂä†Ê∏õËôü) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* ÂãïÁï´ */
        @keyframes slide-in {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .animate-slide-in { animation: slide-in 0.3s ease-out forwards; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div id="app" class="min-h-screen pb-32 w-full overflow-x-hidden">
        <!-- ÂÖßÂÆπÂ∞áÁî± JavaScript ÂãïÊÖãÊ∏≤Êüì -->
    </div>

    <script>
        // --- 1. Êï∏ÊìöÂ∫´ (‰øùÊåÅ‰∏çËÆä) ---
        const RAW_RECIPES = [
            "ËòãÊûúËÇâÊ°ÇÁÉ§ÁáïÈ∫•", "Ëù¶‰ªÅÁâõËÇâÊãåÈ∫µ", "Ê™∏Ê™¨‰πæÁÖéÈõû", "Ê§∞ËèúÁµ≤ÁáòËÇâÁµ≤", "ËñØÁµ≤Â®ÉÂ®ÉËèúÁâõËÇâÁâáËí∏Ëõã", "Ê≥ïÂºèÊ©ôÈ¶ôÁ¥ôÂåÖÈ≠ö", "Áø†ÁéâÁìúÁµ≤Ëù¶‰ªÅÈ§Ö",
            "CajunÈ¶ôÊñôÈõûÈ´ÄÈ£Ø", "Ëù¶‰ªÅËäãÁµ≤ÈùíÁìúÈõûËõãÊ≤ôÂæã", "Spicy Salmon poke bowl", "Miso Mushroom Coconut Milk Udon", "Caesar Salad with chicken",
            "Shepherd‚Äôs Pie", "Ê¥ãËî•Êú®ËÄ≥ÁÇíÈõûËõã", "ÊÑèÂºèËî¨ËèúÊπØ", "Toscana Salmon", "Ëä±Ê§íÈùíÊ§íÁÇíÈõû‰∏Å",
            "ËòãÊûúÁÇñË±¨Êâí", "ÈÖ∏Ëæ£ËñØÁµ≤ÁáòÁâõËÇâ", "Âú∞‰∏≠Êµ∑Ëù¶Áø†ÁéâÁìúÂΩ©Ê§í", "Ê≥ïÂºèËèåËèáÁÇñÈõû", "ËäùÂ£´ÁâõËÇâËî¨ËèúÈçã",
            "ÈªëÊùæÈú≤ËòëËèáËù¶", "ÁôΩËòëËèáÁÇíÈõûÈ´ÄËÇâ", "Â®ÉÂ®ÉËèúÁï™ËåÑÁ≤âÁµ≤ÁáúÁâõËÇâ", "Áï™ËåÑÁâõËÇâË±ÜËÖêÁÖ≤", "Á≤âÁµ≤ÁØÄÁìúËù¶Á±≥",
            "ËòÜÁ≠çÁÉ§‰∏âÊñáÈ≠öËñØ‰ªî", "Ëë°ÂºèËù¶‰ªÅÊ∞¥ÁâõËäùÂ£´ÈõûËõãÊ≤ôÂæã", "Èï∑ÈÇäË±ÜÂçóÁìúÈõûËÇâ", "ÈùíÁìúÁâõÊ≤πÊûúË±ÜËäΩÂ±±ÁæäËäùÂ£´‰∏âÊñáÊ≤ª", "ÁâõÊ≤πÊûúÈõûËÇâÂ∏åËáò‰π≥ÈÖ™wrap",
            "ÁâõÊ≤πÊûúËäíÊûúËù¶‰ªÅËÅñÂ•≥ÊûúÊ≤ôÂæã", "Ë≤ùË≤ùÂçóÁìúËù¶ÈõûËÉ∏ËòÜÁ≠çÁ¥ÖËòøËîîËñØ‰ªîÁ©∫Ê∞£ÁÇ∏Èçã", "ÁÉ§ËñØ‰ªîËù¶‰ªÅËòÜÁ≠çÁôΩËòëËèá", "ÁÉ§Ê§∞ËèúBBÁ¥ÖËñØÈõûËõãÊ≤ôÂæã", "Ë•øËò≠Ëä±ÁâõËÇâÁÇíÁÉèÂÜ¨",
            "Á≤üÁ±≥ÈõûËÉ∏Ê≤ôÂæã", "ÁÉ§Ê§∞ËèúÈÖçRomesco Sauce", "creamy garlic Ë•øËò≠Ëä±‰∏âÊñáÈ≠öpoke", "ËíúÁÉ§ÈõûËÇâÁ¥ÖËòøËîîÁø†ÁéâÁìúËñØ‰ªîË•øËò≠Ëä±", "ÁÉ§ÈõûÈ´ÄÁ≤üÁ±≥ÔºåÂ∏åËáòÊ≤ôÂæã",
            "ÁÉ§È≠öÁÉöËõãËòÜÁ≠çË•øËò≠Ëä±ËñØ‰ªî", "silken tofu pasta", "Áø†ÁéâÁìú+ÁÖô‰∏âÊñáÈ≠ö/ÁÖéËõã/Ëù¶‰ªÅ/ÈõûËÉ∏+ÁâõÊ≤πÊûú/ÁîüËèú/ÁîúÊ§í+Â∞ëÈáèËäùÂ£´Á¢éÂç∑È§Ö", "Â®ÉÂ®ÉËèúÈõûËõãË±ÜËÖêÊπØ", "Â®ÉÂ®ÉËèúÁ≤âÁµ≤ÁÇÜÁâõËÇâ",
            "Ëæ£Âë≥ÈÆÆËù¶ÈõúËî¨", "ËïÉËåÑËñØ‰ªîÁâõËÇâÊπØ", "ËòøËîîÁÖéËõãÊπØ", "ËïÉËåÑÈáëÈáùËèáË±ÜËÖêÊπØ", "Ëè†ËèúÈõûËõãÊπØ",
            "Á¥´ËèúÁâõËÇâËÇâÊπØ", "ËïÉËåÑÁÇíËõã+Ê∏ÖÁÇíËî¨Ëèú", "ËíúÈ¶ôËòëËèáÁÇÜËù¶‰ªÅ/ÁÖéÈõû", "ÈÖ∏Â•∂ËñØ‰ªîÈõûËõãÊ≤ôÂæã", "Áø†ÁéâÁìúÁÇíÁâõËÇâ+ÁÇíË±ÜËäΩ",
            "Ëî¨ËèúÁâõËÇâÈçã", "Tunacado Sandwich", "Âú∞‰∏≠Êµ∑Ê™∏Ê™¨ÁÉ§ÈõûÊ≤ôÂæã", "Creamy Chicken Corn Salad", "Âú∞‰∏≠Êµ∑È¢®Âë≥Ëù¶‰ªÅÁ¢ó",
            "Á¥ÖËòøËîîÁÇíÁâõËÇâ+ÁÇíÊ§∞Ëèú", "ÂΩ©Ê§íÁôæËòëËèáÁÇíÁîüËèúÈõûËÇâ", "ÈùíÊ§íÁÇíÁâõËÇâ+ÁÇíÊ≥ïÈÇäË±Ü", "ÁâõÊ≤πÊûúÈõûËÇâÊ≤ôÂæã", "ÁâõËÇâÁ≤íÁâõÊ≤πÊûúËïÉËåÑÊ¥ãËî•wrap",
            "Ëí∏Ê∞¥Ëõã + ÂçäÊã≥Á≤óÁ≥ß + ÂçäÊã≥ËõãÁôΩË≥™+ ÁÇíËî¨Ëèú", "Ê§∞ËèúÁ¥ÖËòøËîîÁµ≤ÁÇíÈõûËõã", "Shrimp Avocado Lettuce Boats", "Ëù¶‰ªÅËäãÁµ≤Ë•øËò≠Ëä±ÁÇíËõã", "Cucumber and Avocado Sandwich",
            "Italian Frittata", "Ê∏ÖËí∏È±∏È≠ö+ÁÇíËî¨Ëèú", "Êó•ÂºèÈØñÈ≠öÂÆöÈ£ü", "ÊªëËõãËù¶‰ªÅËìãÈ£Ø", "Ê™∏Ê™¨ÊâãÊíïÈõûÂçÉÂºµÊàñËíüËíªÈ∫µÈÖçÁÉ§Ëî¨Ëèú",
            "ÈüìÂºèÊ≥°ËèúË±ÜËÖêËî¨ËèúÈçã", "Â¢®Ë•øÂì•ÈõûËÇâÁ¢ó", "È¶ôÁÖéÈõûËÖøËî¨ËèúÊâÅË±Ü", "Ë∂äÂºèÈÆÆËù¶ÈõúÈå¶Ëî¨ËèúÊò•Âç∑", "Ëó§Ê§íÁâõËÇâÁ≤íÁÇíÊôÇËî¨",
            "Ê∏ÖÁÇñÁôΩËòøËîîÁâõËÇâÊπØ", "Ê¥ãËî•Ë±¨ËÇâËî¨ËèúÊπØÈçã", "ÈõûÈ´ÄÈÇ£‰∏çÂãíÊñØÊÑèÁ≤âÁÉ§Ëî¨Ëèú", "Ê™∏Ê™¨Ëä±Ê§íÁÑóÁâõËÇâÈÖçÊ¥ãËî•ÂΩ©Ê§íËïÉËåÑ‰ªî", "ÈùíÊ§íÈõûËõãÁÇíË±ÜËÖê",
            "Â•ßÁàæËâØÈõûËÉ∏‰∏ÅÊ¥ãËî•ÁÇíÂΩ©Ê§í", "Â•ßÁàæËâØÈõûËÉ∏Ê¢ù", "ÁîüËèúËïÉËåÑ‰ªîÊ≤ôÂæã", "Ê¥ãËî•ÂΩ©Ê§íÁÇíË±¨ËÇù", "ÁÖô‰∏âÊñáÈ≠öÊªëËõãËªäÂéòËåÑÂÖ®È∫•Â§öÂ£´",
            "ËíúÈ¶ôÁâõÊü≥Á≤íËòÜÁ≠çÈÖçËñØ‰ªî", "Ëù¶‰ªÅËÇâÁ¢éÊ§∞ËèúÁµ≤ÁÇíÁ≤âÁµ≤ÁÖ≤", "ÂæÆÊ≥¢ÁàêÁâàËíúËìâËù¶‰ªÅÁ≤âÁµ≤ÁÖ≤", "ÂæÆÊ≥¢ÁàêÊùøÈüìÂºèÊ≥°ËèúÈõûËÇâÈçãËõãÁÖ≤", "ÂæÆÊ≥¢ÁàêÁâàÊ¢ÖËä±ËÇâÈÖ∏ÊπØÂ∞èÁÅ´Èçã",
            "ÂæÆÊ≥¢ÁàêÁâàÂíñÂñ±Ê¥ãËî•Á¥ÖËòøËîîÊ§∞ËèúËä±È≠ö‰∏∏ÁÉèÂÜ¨", "ÂæÆÊ≥¢ÁàêÁâàËïÉËåÑÂåÖÊ≤ôÈ≠öÈ≠îËäãÁµ≤Ë±ÜËÖêÈçã", "ÂæÆÊ≥¢ÁàêÁâàÁÖßÁáíÈõûËÖøËÇâËî¨ËèúÁÖ≤", "Overnight rolled oats + milk + fruit + chia seeds",
            "Ê∏ÖËí∏Ë±ÜËÖêÂ®ÉÂ®ÉËèúËÇâÈ§Ö", "Ê≥ïÂºèÂ∑¥ÊñØÂÖãÁÇñÈõûÈÖçËíüËíªÁ±≥ (Poulet Basquaise)"
        ];

        // --- 2. ÈÇèËºØËôïÁêÜ (‰øùÊåÅ‰∏çËÆä) ---
        const getRecipeType = (name) => {
            const n = name.toLowerCase();
            if (n.includes('oats') || n.includes('ÁáïÈ∫•') || n.includes('toast') || n.includes('sandwich') || n.includes('frittata') || n.includes('breakfast')) {
                return 'breakfast';
            }
            return 'lunch_dinner';
        };

        const RECIPES = RAW_RECIPES.map((name, index) => ({
            id: index,
            name,
            type: getRecipeType(name)
        }));

        const generateIngredients = (name, level, type) => {
            let ings = [];
            const n = name.toLowerCase();
            
            if (n.includes('ËòãÊûúËÇâÊ°ÇÁÉ§ÁáïÈ∫•')) return [{ text: 'ËòãÊûú 1ÂÄã', highlight: false }, { text: 'ÂÖ®Á≤íÁáïÈ∫• (30g)', highlight: false }, { text: 'ÁâõÂ•∂/Ê§çÁâ©Â•∂ (120g)', highlight: false }];
            if (n.includes('Ëù¶‰ªÅÁâõËÇâÊãåÈ∫µ')) return [{ text: 'Ëù¶‰ªÅ & ÁâõËÇâÁâá', highlight: false }, { text: level === 'Low' ? 'ÂçÉÂºµ/Ë±ÜËÖêÁöÆ' : 'ÁÉèÂÜ¨/ËïéÈ∫•È∫µ', highlight: level === 'Low' }, { text: 'ÈùíÁìúÁµ≤ & Á¥ÖËòøËîîÁµ≤', highlight: false }];

            const meatWeight = level === 'Low' ? '120g (Áò¶ËÇâ)' : '150g'; 
            if (n.includes('Èõû')) ings.push({ text: `ÈõûËÇâ: ${meatWeight}`, highlight: false });
            else if (n.includes('Áâõ')) ings.push({ text: `ÁâõËÇâ: ${meatWeight}`, highlight: false });
            else if (n.includes('Ëù¶')) ings.push({ text: 'Ëù¶‰ªÅ (15-20Èöª)', highlight: false });
            else ings.push({ text: 'ÂÑ™Ë≥™ËõãÁôΩË≥™ (140g)', highlight: false });

            ings.push({ text: 'ÊôÇ‰ª§Ëî¨Ëèú (250g+)', highlight: false });

            if (type === 'breakfast') {
                ings.push({ text: level === 'Low' ? 'ÂÖ®È∫•È∫µÂåÖ(1Áâá)' : 'ÁáïÈ∫•/ËïÉËñØ', highlight: false });
            } else {
                if (type === 'dinner' && level === 'Low') ings.push({ text: 'ÊôöÈ§êÁÑ°Êæ±Á≤â (Âè™È£üËèúËÇâ)', highlight: true });
                else ings.push({ text: level === 'Medium' ? 'ÂçäÊã≥Êæ±Á≤â' : '1Á¢óÈ£Ø/È∫µ', highlight: false });
            }
            return ings;
        };

        // --- 3. ÁãÄÊÖãÁÆ°ÁêÜ (‰øùÊåÅ‰∏çËÆä) ---
        const state = {
            currentDayIndex: new Date().getDay(),
            menuOpen: false,
            weeklyData: []
        };

        function initData() {
            const breakfastOpts = RECIPES.filter(r => r.type === 'breakfast');
            const mainOpts = RECIPES.filter(r => r.type === 'lunch_dinner');
            const pick = (arr) => arr.length > 0 ? arr[Math.floor(Math.random() * arr.length)] : RECIPES[0];
            const patternMap = { 1: 'Low', 2: 'Low', 3: 'Medium', 4: 'Medium', 5: 'Low', 6: 'High', 0: 'Medium' };

            for(let i=0; i<7; i++) {
                state.weeklyData.push({
                    dayIndex: i,
                    level: patternMap[i],
                    plan: { 
                        breakfast: pick(breakfastOpts), 
                        lunch: pick(mainOpts), 
                        dinner: pick(mainOpts) 
                    },
                    skipped: { breakfast: false, lunch: false, dinner: false },
                    swapped: { breakfast: false, lunch: false, dinner: false },
                    water: i === new Date().getDay() ? 3 : 0,
                    brazilNut: true
                });
            }
        }

        // --- 4. Êìç‰ΩúÂáΩÊï∏ (‰øùÊåÅ‰∏çËÆä) ---
        function updateState() { render(); }
        function setDay(index) { state.currentDayIndex = index; updateState(); }
        function toggleMenu() { state.menuOpen = !state.menuOpen; updateState(); }
        function toggleMode() {
            const levels = ['Low', 'Medium', 'High'];
            const day = state.weeklyData[state.currentDayIndex];
            const currentIdx = levels.indexOf(day.level);
            day.level = levels[(currentIdx + 1) % 3];
            updateState();
        }
        function toggleBrazilNut() {
            const day = state.weeklyData[state.currentDayIndex];
            day.brazilNut = !day.brazilNut;
            updateState();
        }
        function updateWater(delta) {
            const day = state.weeklyData[state.currentDayIndex];
            let newAmount = day.water + delta;
            if (newAmount < 0) newAmount = 0;
            if (newAmount > 8) newAmount = 8;
            day.water = newAmount;
            updateState();
        }
        function toggleSkip(mealType) {
            const day = state.weeklyData[state.currentDayIndex];
            day.skipped[mealType] = !day.skipped[mealType];
            updateState();
        }
        function swapMeal(mealType) {
            const day = state.weeklyData[state.currentDayIndex];
            const pool = mealType === 'breakfast' 
                ? RECIPES.filter(r => r.type === 'breakfast') 
                : RECIPES.filter(r => r.type === 'lunch_dinner');
            const newMeal = pool[Math.floor(Math.random() * pool.length)];
            day.plan[mealType] = newMeal;
            day.swapped[mealType] = true;
            day.skipped[mealType] = false;
            updateState();
        }

        // --- 5. Ê∏≤ÊüìÂáΩÊï∏ (Â∑≤‰øÆÊîπÔºöÁ∏ÆÂ∞èÂç°ÁâáÔºåÊõ¥Êèõ Emoji) ---
        function render() {
            const app = document.getElementById('app');
            const dayData = state.weeklyData[state.currentDayIndex];
            
            // Ë®àÁÆóÊï∏ÂÄº
            const getTargets = (level) => {
                if (level === 'Low') return { cal: 1200, p: 120, c: 80 };
                if (level === 'Medium') return { cal: 1375, p: 120, c: 120 };
                return { cal: 1525, p: 120, c: 160 };
            };
            const targets = getTargets(dayData.level);
            
            let currentCal = dayData.brazilNut ? 33 : 0;
            let currentP = dayData.brazilNut ? 1 : 0;
            let currentC = dayData.brazilNut ? 0.5 : 0;
            const mealRatios = { breakfast: 0.25, lunch: 0.375, dinner: 0.375 };
            
            ['breakfast', 'lunch', 'dinner'].forEach(type => {
                if (!dayData.skipped[type]) {
                    currentCal += targets.cal * mealRatios[type];
                    currentP += targets.p * mealRatios[type];
                    currentC += targets.c * mealRatios[type];
                }
            });

            const getLevelStyle = (level) => {
                if (level === 'Low') return { bg: 'bg-emerald-100', text: 'text-emerald-700', bar: 'bg-emerald-500', icon: 'leaf' };
                if (level === 'Medium') return { bg: 'bg-blue-100', text: 'text-blue-700', bar: 'bg-blue-500', icon: 'battery' };
                return { bg: 'bg-orange-100', text: 'text-orange-700', bar: 'bg-orange-500', icon: 'flame' };
            };
            const levelStyle = getLevelStyle(dayData.level);
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

            // HTML ÊßãÂª∫
            let html = `
                <!-- È†ÇÈÉ®Â∞éËà™ -->
                <div class="sticky top-0 z-40 bg-white border-b border-gray-200 pt-3 pb-2 px-3 shadow-sm">
                    <div class="flex justify-between items-center mb-2">
                        <h1 class="text-base font-bold text-gray-900">
                            DietPlanner <span class="text-orange-500">Pro</span>
                        </h1>
                        <button onclick="toggleMenu()" class="p-1.5 rounded-full hover:bg-gray-100 text-gray-600">
                            <i data-lucide="menu" class="w-5 h-5"></i>
                        </button>
                    </div>

                    <!-- ÊòüÊúüÈÅ∏ÊìáÂô® -->
                    <div class="grid grid-cols-7 gap-1">
                        ${state.weeklyData.map((d, i) => {
                            const isToday = i === state.currentDayIndex;
                            const dStyle = getLevelStyle(d.level);
                            return `
                                <button onclick="setDay(${i})" class="relative h-12 rounded-lg border transition-all ${isToday ? 'border-gray-800 bg-white shadow-md ring-1 ring-gray-800' : 'border-gray-100 bg-white opacity-60'}">
                                    <div class="absolute top-0 right-0 w-2.5 h-2.5 rounded-bl-lg ${dStyle.bg}"></div>
                                    <div class="h-full flex flex-col justify-center items-center">
                                        <span class="text-[9px] font-bold text-gray-400 uppercase">${days[i]}</span>
                                        <span class="text-xs font-bold ${isToday ? 'text-gray-900' : 'text-gray-500'}">${d.level[0]}</span>
                                    </div>
                                </button>
                            `;
                        }).join('')}
                    </div>
                </div>

                <!-- Â£ìÁ∏ÆÁâàÂÑÄË°®Êùø -->
                <div class="px-3 mt-3">
                    <div class="bg-white rounded-xl p-3 shadow-sm border border-gray-100">
                        <!-- Ê®ôÈ°åË°å -->
                        <div class="flex justify-between items-center mb-2">
                            <span class="flex items-center space-x-1 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider ${levelStyle.bg} ${levelStyle.text}">
                                <i data-lucide="${levelStyle.icon}" class="w-3 h-3"></i>
                                <span>${dayData.level}</span>
                            </span>
                            
                            <div class="flex items-center space-x-2">
                                <button onclick="toggleBrazilNut()" class="px-1.5 py-0.5 rounded-full border text-[10px] font-bold transition-colors ${dayData.brazilNut ? 'bg-amber-100 text-amber-800 border-amber-200' : 'bg-gray-50 text-gray-400 border-gray-100'}">
                                    üå∞ Â∑¥Ë•øÂ†ÖÊûú
                                </button>
                                <button onclick="toggleMode()" class="w-7 h-4 rounded-full relative transition-colors ${dayData.level === 'Low' ? 'bg-emerald-500' : dayData.level === 'Medium' ? 'bg-blue-500' : 'bg-orange-500'}">
                                    <div class="absolute top-0.5 left-0.5 bg-white w-3 h-3 rounded-full shadow transition-transform ${dayData.level === 'Low' ? 'translate-x-0' : dayData.level === 'Medium' ? 'translate-x-1.5' : 'translate-x-3'}"></div>
                                </button>
                            </div>
                        </div>

                        <!-- Âç°Ë∑ØÈáåÂ§ßÂ≠ó -->
                        <div class="flex items-baseline mb-2">
                            <span class="text-2xl font-bold text-gray-900 mr-1">${Math.round(currentCal)}</span>
                            <span class="text-xs text-gray-400">/ ${targets.cal} kcal</span>
                        </div>

                        <!-- ÁáüÈ§äÁ¥† (‰∏¶ÊéíÈ°ØÁ§∫‰ª•ÁØÄÁúÅÁ©∫Èñì) -->
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <div class="flex justify-between text-[10px] mb-1">
                                    <span class="font-medium text-gray-500">ËõãÁôΩË≥™</span>
                                    <span class="text-gray-900 font-bold">${Math.round(currentP)}/${targets.p}g</span>
                                </div>
                                <div class="w-full bg-gray-100 rounded-full h-1.5 overflow-hidden">
                                    <div class="h-full bg-slate-800 rounded-full" style="width: ${Math.min((currentP/targets.p)*100, 100)}%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-[10px] mb-1">
                                    <span class="font-medium text-gray-500">Á¢≥Ê∞¥</span>
                                    <span class="text-gray-900 font-bold">${Math.round(currentC)}/${targets.c}g</span>
                                </div>
                                <div class="w-full bg-gray-100 rounded-full h-1.5 overflow-hidden">
                                    <div class="h-full rounded-full transition-colors ${levelStyle.bar}" style="width: ${Math.min((currentC/targets.c)*100, 100)}%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Â£ìÁ∏ÆÁâàÈ£≤Ê∞¥ËøΩËπ§Âô® -->
                <div class="px-3 mt-3">
                    ${dayData.water >= 8 ? `
                        <!-- ÊÖ∂Á•ùÁãÄÊÖã (Â£ìÁ∏Æ) -->
                        <div class="bg-[#FFFEF0] border border-yellow-100 rounded-xl p-3 shadow-sm relative overflow-hidden flex items-center justify-between">
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 rounded-lg bg-[#FFF9C4] flex items-center justify-center">
                                    <i data-lucide="droplet" class="w-4 h-4 text-[#FBC02D] fill-[#FBC02D]"></i>
                                </div>
                                <div>
                                    <h3 class="text-sm font-bold text-slate-900">Hydration Goal!</h3>
                                    <p class="text-[10px] text-[#9E7F13]">8/8 Cups üéâ</p>
                                </div>
                            </div>
                            <div class="flex space-x-1">
                                <button onclick="updateWater(-1)" class="w-7 h-7 rounded-full border border-gray-200 bg-white flex items-center justify-center text-gray-400">
                                    <i data-lucide="minus" class="w-3 h-3"></i>
                                </button>
                                <button onclick="updateWater(1)" class="w-7 h-7 rounded-full bg-[#FDD835] text-white flex items-center justify-center shadow-sm">
                                    <i data-lucide="plus" class="w-3 h-3"></i>
                                </button>
                            </div>
                        </div>
                    ` : `
                        <!-- ÊôÆÈÄöÁãÄÊÖã (Â£ìÁ∏Æ) -->
                        <div class="bg-white rounded-xl p-2 pr-2 shadow-sm border border-gray-100 flex items-center justify-between h-12">
                            <div class="flex items-center h-full pl-1 flex-1">
                                <!-- ÁúÅÁï•Â§ßÂúìÂúàÂúñÊ®ôÔºåÁõ¥Êé•È°ØÁ§∫ÈÄ≤Â∫¶Èªû -->
                                <div class="flex items-center space-x-1 mr-2">
                                    <i data-lucide="droplet" class="w-4 h-4 text-blue-500 fill-blue-500 mr-1"></i>
                                    ${Array(8).fill(0).map((_, i) => `
                                        <div class="w-1.5 h-1.5 rounded-full flex-shrink-0 ${i < dayData.water ? 'bg-blue-500' : 'bg-blue-100'}"></div>
                                    `).join('')}
                                </div>
                            </div>
                            <div class="flex items-center space-x-2 pr-1">
                                <span class="text-gray-500 font-bold text-xs whitespace-nowrap">${dayData.water * 250}ml</span>
                                <div class="flex space-x-1">
                                    <button onclick="updateWater(-1)" class="w-7 h-7 rounded-full border border-gray-200 flex items-center justify-center text-gray-400 hover:bg-gray-50">
                                        <i data-lucide="minus" class="w-3 h-3"></i>
                                    </button>
                                    <button onclick="updateWater(1)" class="w-7 h-7 rounded-full bg-blue-600 text-white flex items-center justify-center shadow-sm shadow-blue-200">
                                        <i data-lucide="plus" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `}
                </div>

                <!-- È§êÂñÆÂàóË°® (EmojiÁâà) -->
                <div class="px-3 mt-4 space-y-3 pb-10">
                    ${['breakfast', 'lunch', 'dinner'].map(type => {
                        const meal = dayData.plan[type];
                        const skipped = dayData.skipped[type];
                        const swapped = dayData.swapped[type];
                        const ingredients = generateIngredients(meal.name, dayData.level, type);
                        const displayCal = Math.round(targets.cal * mealRatios[type]);
                        
                        // ‰ΩøÁî® Emoji Êõø‰ª£ Vector Icons
                        const emojis = { breakfast: '‚òï', lunch: '‚òÄÔ∏è', dinner: 'üåô' };
                        const labels = { breakfast: 'Êó©È§ê', lunch: 'ÂçàÈ§ê', dinner: 'ÊôöÈ§ê' };

                        return `
                            <div class="bg-white border rounded-xl p-4 shadow-sm transition-all ${skipped ? 'opacity-60 bg-gray-50 border-dashed border-gray-300' : 'border-gray-100'}">
                                <div class="flex justify-between items-center mb-2">
                                    <div class="flex items-center space-x-2 text-gray-700">
                                        <span class="text-lg">${emojis[type]}</span>
                                        <span class="text-sm font-bold text-gray-900">${labels[type]}</span>
                                        ${swapped ? '<span class="text-[9px] bg-blue-50 text-blue-600 px-1.5 py-0.5 rounded font-bold">Â∑≤Êõ¥Êñ∞</span>' : ''}
                                    </div>
                                    <span class="text-[10px] text-gray-400 font-mono border border-gray-100 px-1.5 py-0.5 rounded">
                                        ${displayCal} kcal
                                    </span>
                                </div>

                                <div class="mb-3">
                                    <div class="flex justify-between items-start">
                                        <h3 class="text-base font-bold text-gray-800 leading-snug w-full ${skipped ? 'line-through' : ''}">
                                            ${meal.name}
                                        </h3>
                                        <div class="flex space-x-1 ml-2 flex-shrink-0">
                                            <button onclick="swapMeal('${type}')" class="p-1.5 rounded-full bg-gray-50 text-gray-400 hover:text-blue-600">
                                                <i data-lucide="refresh-cw" class="w-3.5 h-3.5"></i>
                                            </button>
                                            <button onclick="toggleSkip('${type}')" class="p-1.5 rounded-full bg-gray-50 text-gray-400 hover:text-red-500">
                                                <i data-lucide="${skipped ? 'rotate-ccw' : 'x'}" class="w-3.5 h-3.5"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                ${!skipped ? `
                                    <div class="space-y-1.5 mb-3">
                                        ${ingredients.map(ing => `
                                            <div class="flex items-start space-x-2">
                                                <div class="mt-1 text-emerald-500 flex-shrink-0"><i data-lucide="check" class="w-3 h-3" stroke-width="3"></i></div>
                                                <span class="text-xs leading-relaxed ${ing.highlight ? 'text-red-500 font-bold' : 'text-gray-600'}">
                                                    ${ing.text}
                                                </span>
                                            </div>
                                        `).join('')}
                                    </div>

                                    <div class="bg-[#FFFBEB] p-2 rounded-lg flex items-start space-x-2">
                                        <div class="text-yellow-500 mt-0.5 flex-shrink-0"><i data-lucide="lightbulb" class="w-3 h-3"></i></div>
                                        <span class="text-[10px] text-[#92400E] leading-relaxed font-medium">
                                            ${dayData.level === 'Low' ? 'Ê∏õËÑÇÊó•ÔºöÂ∞àÊ≥®ËõãÁôΩË≥™ËàáÁ∫ñÁ∂≠ÔºåÊôöÈ§êÈÅøÂÖçÊæ±Á≤â„ÄÇ' : 'Âπ≥Ë°°/È´òÁ¢≥Êó•ÔºöÈÅ©ÈáèÁ¢≥Ê∞¥ÊîØÊåÅÊó•Â∏∏Ê¥ªÂãï„ÄÇ'}
                                        </span>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    }).join('')}
                </div>

                <!-- ËèúÂñÆ Drawer (‰øùÊåÅ‰∏çËÆä) -->
                ${state.menuOpen ? `
                    <div class="fixed inset-0 z-50 flex justify-end">
                        <div class="absolute inset-0 bg-black/30 backdrop-blur-sm" onclick="toggleMenu()"></div>
                        <div class="relative w-4/5 max-w-sm bg-white h-full shadow-2xl flex flex-col animate-slide-in">
                            <div class="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                                <h2 class="text-base font-bold text-gray-900">ËèúÂñÆË≥áÊñôÂ∫´</h2>
                                <button onclick="toggleMenu()" class="p-1 rounded-full hover:bg-gray-200">
                                    <i data-lucide="x" class="w-5 h-5"></i>
                                </button>
                            </div>
                            <div class="flex-1 overflow-y-auto p-4">
                                <div class="space-y-2">
                                    ${RECIPES.map(r => `
                                        <div class="text-xs text-gray-700 p-2 bg-gray-50 rounded border border-gray-100">
                                            ${r.name}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                ` : ''}
            `;

            app.innerHTML = html;
            lucide.createIcons(); // ÈáçÊñ∞Ê∏≤ÊüìÂúñÊ®ô
        }

        // --- 6. ÂïüÂãï ---
        initData();
        render();

    </script>
</body>
</html>